# Update Static Assets

[![Build status](https://github.com/martincostello/update-static-assets/workflows/build/badge.svg?branch=main&event=push)](https://github.com/martincostello/update-static-assets/actions?query=workflow%3Abuild+branch%3Amain+event%3Apush)
[![codecov](https://codecov.io/gh/martincostello/update-static-assets/branch/main/graph/badge.svg)](https://codecov.io/gh/martincostello/update-static-assets)
[![OpenSSF Scorecard](https://api.securityscorecards.dev/projects/github.com/martincostello/update-static-assets/badge)](https://api.securityscorecards.dev/projects/github.com/martincostello/update-static-assets)

This action updates static assets for HTML-related files stored in a GitHub repository.

An example pull request created by the action can be found [here](https://github.com/martincostello/costellobot/pull/167).

The following CDNs are supported:

- [cdnjs](https://cdnjs.com/)
- [jsDelivr](https://www.jsdelivr.com/)

## Example Usage

```yml
steps:
- uses: actions/checkout@v3
- uses: martincostello/update-static-assets@v1
  with:
    repo-token: ${{ secrets.GITHUB_TOKEN }}
```

### Example Workflow

Below is an example of a full GitHub Actions workflow to automate static asset updates.

```yml
name: update-static-assets

on:

  # Scheduled trigger to check for static asset updates once a day at 5AM
  schedule:
    - cron:  '0 5 * * *'

  # Manual trigger to update static assets on demand
  workflow_dispatch:

jobs:
  update-static-assets:
    name: Update static assets
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: martincostello/update-static-assets@v1
      with:
        repo-token: ${{ secrets.GITHUB_TOKEN }}
```

## Inputs

## Required

| **Name** | **Description** |
|:--|:--|
| `repo-token` | The GitHub access token to use to create a pull request for any updates to the repository. |

### Optional

| **Name** | **Description** | **Default** |
|:--|:--|:--|
| `branch-name-prefix` | The optional Git branch name prefix to use. | - |
| `commit-message` | The optional Git commit message to use. | - |
| `configuration-file` | The optional path to a configuration file to use (see [configuration](#configuration)). | `.update-static-assets.json` |
| `file-extensions` | The optional comma-separated file extension(s) to search for static assets within. | `cshtml,html,razor` |
| `labels` | The optional comma-separated label(s) to apply to pull requests generated by the action. | - |
| `repo-path` | The optional path of the repository to check for updates. | `.` |
| `user-email` | The optional email address to use for Git commits. | `github-actions[bot]@users.noreply.github.com` |
| `user-name` | The optional user name to use for Git commits. | `github-actions[bot]` |
| `dry-run` | If true, the action will not push changes to GitHub. | `false` |

## Outputs

| **Name** | **Description** |
|:--|:--|
| `assets-updated` | Whether any static assets were updated by the action. |

## Configuration

Additional options can be specified with a JSON configuration file.
The file's path can be specified with the `configuration-file` input.

To ignore updates for a specific asset, add an item to the `ignore`
property of the configuration file specifying the asset CDN and name
to ignore along with a
[Regular Expression](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions)
that specifies the version(s) of the asset to ignore updates for.

An example configuration file is shown below.

```json
{
    "ignore": [
        {
            "cdn": "cdnjs",
            "name": "bootstrap",
            "version": "6\\..*"
        }
    ]
}
```

## Feedback

Any feedback or issues can be added to the issues for this project in [GitHub](https://github.com/martincostello/update-static-assets/issues).

## Repository

The repository is hosted in [GitHub](https://github.com/martincostello/update-static-assets): https://github.com/martincostello/update-static-assets.git

## License

This project is licensed under the [Apache 2.0](https://www.apache.org/licenses/LICENSE-2.0.txt) license.
